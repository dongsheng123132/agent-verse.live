# 需求文档：Conflux 打赏与红包（海外华人参与）

**版本**：v1.0  
**适用赛题**：Conflux 挑战3 - 开发 Conflux 链上 PoC，赋能「一带一路」跨境场景  
**场景**：AI 春晚 / 未来奥林匹克、AI 黑客松 — 海外华人通过 Conflux 参与打赏与抢红包

---

## 1. 场景与目标

### 1.1 业务场景

- **活动方**：AgentVerse 举办线上活动（AI 春晚、奥林匹克、AI 黑客松等），面向全球观众与海外华人。
- **痛点**：海外用户无法使用国内支付渠道；传统跨境支付慢、贵、不透明；活动方希望实时打赏与红包互动。
- **方案**：基于 Conflux 链（eSpace）与稳定币（或 CFX），实现「打赏」与「直播红包」两类支付能力，让海外华人点击即参与。

### 1.2 目标用户

- **打赏**：愿意为节目/活动付费的观众（含海外华人），持有 Conflux 钱包与稳定币（或 CFX）。
- **红包**：观看直播的人类观众，通过「领取红包」参与互动，无需提前充值（由主办方/赞助方先发红包）。

### 1.3 成功标准

- 用户可在活动页完成「选择金额 → 打赏」全流程，资金上链可查。
- 用户可在直播中点击「领取红包」并收到链上发放的金额，每地址每场限领一次（可配置）。
- 满足 Conflux 挑战3 必须实现：真实场景描述、PoC 演示、包含支付功能。

---

## 2. 功能需求

### 2.1 功能一：打赏（点击即付款）

| 项目 | 说明 |
|------|------|
| **名称** | 打赏 / Tip |
| **触发** | 用户在活动页/直播页点击「打赏」入口。 |
| **用户操作** | 1）选择金额（固定档或自定义）；2）点击确认打赏；3）唤起 Conflux 钱包并确认交易。 |
| **系统行为** | 从用户钱包向「活动收款地址」或「打赏合约」转入指定数量的稳定币（或 CFX）；交易上链后前端展示成功态与交易链接。 |
| **展示** | 可选：打赏墙（最近打赏记录、金额、交易链接），数据来源于链上事件或链上查询。 |

**金额与资产**

- 支持 Conflux eSpace 上的稳定币（如 USDT）或 CFX；优先稳定币以符合「跨境结算」叙事。
- 金额档位可由前端配置（如 5 / 10 / 50 / 100 USDT 及自定义输入上限）。

**约束**

- 仅支持已连接 Conflux 钱包的用户；未连接时引导安装钱包（如 Fluent）并连接。
- 单笔打赏金额需在合约或前端限制范围内（防误操作与合规）。

### 2.2 功能二：红包（直播时点击领取）

| 项目 | 说明 |
|------|------|
| **名称** | 红包 / Red Packet |
| **发红包** | 主办方/运营在后台或专用页面「发红包」：填写总金额、份数（或总个数），通过钱包向红包合约充值；合约记录该场次红包池。 |
| **领红包** | 直播/活动进行中，观众在页面看到「领取红包」按钮；点击后唤起钱包并调用合约 `claim`；合约按规则（均分或随机）向该地址转一笔，并标记该地址已领。 |
| **规则** | 每地址每场活动仅可领取一次；领完即止（达到份数或池子为空）；先到先得。 |

**发红包侧**

- 选择活动场次（如春晚 2026）、总金额、份数；调用合约存入对应稳定币（或 CFX），合约记录 `eventId`、总金额、总份数、已领份数。

**领红包侧**

- 用户点击「领取红包」→ 连接钱包（若未连接）→ 调用合约 `claim(eventId)` → 用户确认交易 → 合约校验未领过、仍有剩余，转账并更新状态；前端展示「恭喜领到 x USDT」及交易链接。

**约束**

- 每人每场限领 1 次，由合约保证。
- 前端可展示「剩余份数」或「已领完」，数据来自合约只读接口或事件。

---

## 3. 非功能需求

- **链与网络**：先支持 Conflux eSpace 测试网，主网作为演示或上线目标；钱包连接与 RPC 可配置。
- **兼容性**：支持主流 Conflux 钱包（如 Fluent）；前端适配桌面与移动端。
- **安全**：私钥与签名仅发生在用户钱包内，站点不触碰私钥；合约需防重入、限领一次、金额校验。
- **可扩展**：打赏与红包均与「活动 ID」关联，便于后续扩展至奥林匹克、AI 黑客松等多场活动。

---

## 4. 与赛题的对应关系

| 赛题要求 | 本方案对应 |
|----------|------------|
| 描述一个真实场景中存在的具体需求或问题 | 文档第 1 节：海外华人参与中国主办活动的跨境支付与互动需求。 |
| 演示 PoC 如何解决选定问题 | 打赏 + 红包两个功能构成完整 PoC，演示视频展示从打赏到领红包的链上闭环。 |
| 包含支付功能 | 打赏为「用户 → 活动」支付；红包为「活动池 → 用户」支付，均走 Conflux 链上。 |
| 可选：与 Conflux 生态结合 | 使用 Conflux eSpace、稳定币或 CFX，可提及 Conflux 生态钱包与浏览器。 |

---

## 5. 交付物

- 本需求文档（PRD）。
- 技术实现文档（见 `TECH-Conflux-PayFi.md`）。
- 智能合约源码与部署说明（Conflux eSpace）。
- 前端改动（打赏入口、红包入口、钱包连接、交易状态展示）。
- 场景描述文档（1～2 页，用于提交）。
- 演示视频：海外视角打赏 + 领取红包全流程。

---

*文档结束*
